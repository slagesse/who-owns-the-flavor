<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Who Owns the Flavor</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bodoni+Moda:ital,opsz,wght@0,6..96,400..900;1,6..96,400..900&family=Instrument+Serif:ital@0;1&display=swap" rel="stylesheet">

  <style>
    :root {
      --cream: #f3f3e7;
      --red1: #890d04;
      --gray: rgba(0, 0, 0, 0.25);
    }

    html { scroll-behavior: smooth; }

    body {
      margin: 0;
      background-color: var(--cream);
      font-family: "Instrument Serif", serif;
      color: #000;
    }

    /* === NAVIGATION === */
    nav {
      display: flex;
      align-items: center;
      justify-content: center;
      position: sticky;
      top: 0;
      background-color: var(--cream);
      padding: 2rem 0;
      z-index: 100;
      border-bottom: 1px solid transparent;
      transition: border-bottom 0.4s ease;
    }

    nav.scrolled { border-bottom: 1px solid var(--gray); }

    nav ul {
      list-style: none;
      display: flex;
      gap: 1rem;
      padding: 0;
      margin: 0;
      align-items: center;
    }

    nav a {
      color: black;
      font-size: 2rem;
      font-family: "Instrument Serif", serif;
      transition: color 0.2s ease;
    }

    nav a:hover { color: var(--red1); }

    h1 {
      font-weight: 800;
      font-style: italic;
      font-size: 4rem;
      text-align: center;
      line-height: 1;
      transition: opacity 0.5s ease, font-size 0.5s ease;
    }

    h1.shrunk { font-size: 2.4rem; }
    h1.fade { opacity: 0; }

    .nav-left, .nav-right {
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .separator {
      width: 2px;
      height: 4rem;
      background-color: gray;
      margin: 0 2rem;
      transition: opacity 0.4s ease;
    }

    .separator.hidden { opacity: 0; }

    /* === HERO SECTION === */
    .hero-section {
      position: relative;
      height: auto; /* Allow the section to adjust height dynamically */
      max-height: none; /* Remove the max height constraint */
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: var(--cream);
      overflow: hidden;
    }

    .map-container {
      position: relative;
      display: inline-block;
      overflow: visible;
      transform: translateX(-30%); /* Adjusted to shift the map slightly to the right */
    }

    .map-container img {
      width: 2160px; /* Changed from 2340px to 2160px (1800 * 1.2) */
      height: auto;
      display: block;
      object-fit: contain;
    }

    /* === STAR ICONS === */
    @keyframes star-spin-1 {
      0% { transform: rotate(-15deg); }
      100% { transform: rotate(10deg); }
    }

    @keyframes star-spin-2 {
      0% { transform: rotate(10deg); }
      100% { transform: rotate(-5deg); }
    }

    @keyframes star-spin-3 {
      0% { transform: rotate(-8deg); }
      100% { transform: rotate(15deg); }
    }

    .map-star[data-id="1"] {
      animation: star-spin-1 2.1s ease-in-out infinite alternate; /* 2.5s -> 2.1s */
    }

    .map-star[data-id="2"] {
      animation: star-spin-2 2.5s ease-in-out infinite alternate; /* 3s -> 2.5s */
    }

    .map-star[data-id="3"] {
      animation: star-spin-3 2.9s ease-in-out infinite alternate; /* 3.5s -> 2.9s */
    }

    .map-star {
      position: absolute;
      width: 104px; /* Changed from 120px to 104px (80 * 1.3) */
      height: 104px; /* Changed from 120px to 104px (80 * 1.3) */
      fill: var(--red1);
      stroke: white;
      stroke-width: 1.5px;
      cursor: pointer;
      transform-origin: center;
      transition: transform 0.25s ease, fill 0.25s ease;
      z-index: 3;
    }

    .map-star:hover {
      transform: scale(1.5) rotate(0deg);
      fill: white;
      stroke: black;
    }

    .map-star.active {
      fill: white;
      stroke: black;
      transform: scale(1.4);
      filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.8)) 
              drop-shadow(0 0 16px rgba(255, 255, 255, 0.6))
              drop-shadow(0 0 24px rgba(255, 255, 255, 0.4));
    }

    /* === OVERLAY BOX === */
    .hero-overlay {
      position: absolute;
      left: 65%;
      top: 55%;
      transform: translate(-50%, -50%) scaleY(0.95);
      background-color: white; /* Changed from black to white */
      color: black; /* Changed from white to black */
      border: 1px solid black; /* Changed from white to black */
      padding: 2rem 2.5rem;
      height: auto;
      width: 550px;
      font-family: "Instrument Serif", serif;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      z-index: 2;
      transition: transform 0.4s ease, opacity 0.3s ease;
    }

    .hero-overlay.fade h2,
    .hero-overlay.fade p {
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .hero-overlay.active {
      transform: translate(-50%, -50%) scaleY(1);
    }

    .hero-overlay h2 {
      font-size: 4rem; /* Scale up heading by 1.5x */
      font-weight: 800;
      margin: 0 0 0.8rem;
      transition: opacity 0.3s ease;
      color: var(--red1);
    }

    .hero-overlay p {
      font-size: 1.6rem; /* Scale up paragraph by 1.5x */
      margin: 0;
      line-height: 1.4;
      font-family: monospace;
      font-weight: lighter;
      font-style: italic;

      transition: opacity 0.3s ease;
    }

    /* === AUDIO PLAYER === */
    .audio-player {
      display: none;
      align-items: center;
      gap: 0.8rem;
      margin-top: 1rem;
      justify-content: flex-end; /* Align audio player elements to the right */
    }

    .audio-player.visible { display: flex; }

    .play-btn {
      background: none;
      border: 3px solid var(--red1);
      color: var(--red1);
      font-size: 2rem; /* Double the font size */
      padding: 0.6rem 1.4rem; /* Double the padding */
      border-radius: 8px; /* Double the border radius */
      cursor: pointer;
      transition: background 0.2s ease, color 0.2s ease;
    }

    .play-btn:hover {
      background: var(--red1);
      color: white; /* Ensure contrast on hover */
    }

    .progress-container {
      flex: 1;
      height: 8px; /* Double the height */
      background: gray;
      border-radius: 4px; /* Double the border radius */
      overflow: hidden;
      position: relative;
    }

    .progress-bar {
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 0%;
      background: var(--red1);
      transition: width 0.2s linear;
    }

    .timestamp {
      font-size: 2rem;
      font-family: helvetica;
    }

    @media (max-width: 900px) {
      .hero-overlay { left: 0; }
    }

    /* === ABOUT SECTION === */
    .about-wrapper {
      max-width: 900px;
      margin: 8rem auto; /* Increased from 4rem to 8rem */
      padding: 0 2rem;
      scroll-margin-top: 140px;
    }

    .page-title {
      font-family: "Instrument Serif", serif;
      font-style: italic;
      font-size: 6rem; /* Increased from 3rem */
      color: var(--red1);
      margin-bottom: 3rem;
      text-align: center; /* Changed from left to center */
    }

    .about-block {
      display: flex;
      align-items: center;
      gap: 3rem;
      margin-bottom: 4rem;
    }

    .about-block:nth-child(even) { flex-direction: row-reverse; }

    .about-text { flex: 1; }

    .about-text h3 {
      font-family: "Instrument Serif", serif;
      font-style: italic;
      font-size: 3rem;
      color: var(--red1);
      margin: 0 0 1rem;
    }

    .about-text p {
      font-family: "Bodoni Moda", serif;
      color: black;
      font-size: 1.1rem;
      line-height: 1.6;
      margin: 0;
    }

    .about-img {
      width: 300px;
      height: 200px;
      background-color: #ddd;
      flex-shrink: 0;
    }

    .context-image {
      position: absolute;
      width: 550px; /* Same as overlay box */
      height: 300px;
      background-color: #ddd;
      opacity: 0;
      transition: opacity 0.4s ease;
      z-index: 1;
      border-radius: 15px;
      border: 2px solid black;
    }

    .top-image {
      bottom: calc(100% + 40px); /* 20px spacing */
    }

    .bottom-image {
      top: calc(100% + 40px);
    }

    .context-image.visible {
      opacity: 1;
    }
  </style>
</head>

<body>
  <nav id="navbar">
    <div class="nav-left">
      <ul>
        <li><a href="news.html">NEWS</a></li>
        <li><a href="resources.html">RESOURCES</a></li>
      </ul>
    </div>
    <div class="separator" id="left-sep"></div>
    <h1 id="title">WHO OWNS<br>THE <span style="color: var(--red1)">FLAVOR?</span></h1>
    <div class="separator" id="right-sep"></div>
    <div class="nav-right">
      <ul>
        <li><a href="#about">ABOUT</a></li>
        <li><a href="contact.html">CONTACT</a></li>
      </ul>
    </div>
  </nav>

  <div class="hero-section">
    <div class="map-container">
      <img src="map.svg" alt="Map showing cultural food regions">

      <svg class="map-star" data-id="1" viewBox="0 0 24 24" style="top: 46%; left: 62%;">
        <polygon points="12,2 14.9,8.6 22,9.3 16.5,14.1 18,21 12,17.3 6,21 7.5,14.1 2,9.3 9.1,8.6"/>
      </svg>
      <svg class="map-star" data-id="2" viewBox="0 0 24 24" style="top: 57%; left: 63%;">
        <polygon points="12,2 14.9,8.6 22,9.3 16.5,14.1 18,21 12,17.3 6,21 7.5,14.1 2,9.3 9.1,8.6"/>
      </svg>
      <svg class="map-star" data-id="3" viewBox="0 0 24 24" style="top: 77%; left: 64%;">
        <polygon points="12,2 14.9,8.6 22,9.3 16.5,14.1 18,21 12,17.3 6,21 7.5,14.1 2,9.3 9.1,8.6"/>
      </svg>
    </div>
    <div class="hero-overlay" id="overlay-box">
      <div class="context-image top-image" id="top-image"></div>
      <div class="context-image bottom-image" id="bottom-image"></div>
      <h2>Along the Mississippi</h2>
      <p>Click on a star to hear that city's episode...</p>
  
      <div class="audio-player" id="audio-player">
        <button class="play-btn" id="play-btn">►</button>
        <div class="progress-container">
          <div class="progress-bar" id="progress-bar"></div>
        </div>
        <span class="timestamp" id="timestamp">0:00</span>
      </div>
    </div>
  </div>

  <div class="about-wrapper" id="about">
    <h2 class="page-title">OUR MISSION</h2>
    <p style="font-size: 1.1rem; line-height: 1.8; max-width: 800px; margin: 0 auto;">
      While cultural appropriation in food has been extensively covered from social and cultural perspectives, the business mechanics driving this phenomenon remain largely unexplored.
      <br><br>
      This investigation will be the first to comprehensively examine the economic infrastructure of cultural appropriation in America's food industry, revealing how the extraction of cultural capital has become a systematic business model worth billions of dollars.
      <br><br>
      The story centers on a fundamental question: Who profits when culture becomes commodity?
      <br><br>
      Through meticulous financial reporting and legal documentation, this investigation will trace the money flows that transform community food traditions into corporate revenue streams, exposing the sophisticated mechanisms by which cultural heritage is monetized while original communities are systematically excluded from the profits.
    </p>
  </div>

  <script>
    const overlayBox = document.getElementById("overlay-box");
    const overlayTitle = overlayBox.querySelector("h2");
    const overlayText = overlayBox.querySelector("p");
    const audioPlayer = document.getElementById("audio-player");
    const playBtn = document.getElementById("play-btn");
    const progressBar = document.getElementById("progress-bar");
    const timestamp = document.getElementById("timestamp");
    const stars = document.querySelectorAll(".map-star");

    const starData = {
      1: { 
        title: "St. Louis, Missouri", 
        text: "Dive into The Hill: an Italian-American neighborhood and birthplace of toasted ravioli.",
        topImage: "https://i.ibb.co/0V8XnKmD/toasted-ravs.jpg",
        bottomImage: "https://i.ibb.co/LDx5ZQjZ/DSC09447.jpg"
      },
      2: { 
        title: "Memphis, Tennessee", 
        text: "Where blues, ribs, and Southern grit meet history.",
        topImage: "https://i.ibb.co/wN2V8fHz/dry-ribs.jpg",
        bottomImage: "https://i.ibb.co/XrB6frXt/bar-b-q-shop.jpg"
      },
      3: { 
        title: "New Orleans, Louisiana", 
        text: "Creole flavor, Cajun spice, and centuries of fusion.",
        topImage: "https://i.ibb.co/1thkwCD6/nola-streets.jpg",
        bottomImage: "https://i.ibb.co/8LdSjDkG/po-boy.jpg"
      }
    };

    let activeStar = null;

    stars.forEach(star => {
      star.addEventListener("click", () => {
        const id = star.getAttribute("data-id");

        // If same star clicked again — untoggle
        if (activeStar === id) {
          stars.forEach(s => s.classList.remove("active")); // Add this line to ensure all stars are reset
          activeStar = null;
          hideOverlay();
          return;
        }

        // Activate new star
        stars.forEach(s => s.classList.remove("active"));
        star.classList.add("active");
        activeStar = id;
        showOverlay(id);
      });
    });

    const topImage = document.getElementById("top-image");
    const bottomImage = document.getElementById("bottom-image");

    function showOverlay(id) {
      fadeOverlay(() => {
        overlayTitle.textContent = starData[id].title;
        overlayText.textContent = starData[id].text;
        audioPlayer.classList.add("visible");
        overlayBox.classList.add("active");
        // Set background images
        topImage.style.backgroundImage = starData[id].topImage ? `url(${starData[id].topImage})` : 'none';
        bottomImage.style.backgroundImage = starData[id].bottomImage ? `url(${starData[id].bottomImage})` : 'none';
        topImage.style.backgroundSize = 'cover';
        bottomImage.style.backgroundSize = 'cover';
        topImage.classList.add("visible");
        bottomImage.classList.add("visible");
        progressBar.style.width = "0%";
        timestamp.textContent = "0:00";
      });
    }

    function hideOverlay() {
      // Remove image visibility first
      topImage.classList.remove("visible");
      bottomImage.classList.remove("visible");
      
      fadeOverlay(() => {
        overlayTitle.textContent = "Along the Mississippi";
        overlayText.textContent = "Click on a star to hear that city's episode...";
        audioPlayer.classList.remove("visible");
        overlayBox.classList.remove("active");
        // Reset audio player state
        if (playing) {
          clearInterval(interval);
          playing = false;
        }
        progress = 0;
        playBtn.textContent = "►";
      });
    }

    function fadeOverlay(updateFn) {
      overlayBox.classList.add("fade");
      setTimeout(() => {
        updateFn();
        overlayBox.classList.remove("fade");
      }, 300);
    }

    // === AUDIO PLAYER ===
    let playing = false, progress = 0, interval;
    playBtn.addEventListener("click", () => {
      if (!playing) {
        playBtn.textContent = "❚❚";
        playing = true;
        interval = setInterval(() => {
          if (progress >= 100) {
            clearInterval(interval);
            playBtn.textContent = "►";
            playing = false;
            progress = 0;
          } else {
            progress++;
            progressBar.style.width = progress + "%";
            timestamp.textContent = "0:" + String(Math.floor(progress / 2)).padStart(2, "0");
          }
        }, 100);
      } else {
        clearInterval(interval);
        playBtn.textContent = "►";
        playing = false;
      }
    });

    // === Shrinking Nav ===
    const nav = document.getElementById("navbar");
    const title = document.getElementById("title");
    const leftSep = document.getElementById("left-sep");
    const rightSep = document.getElementById("right-sep");
    let scrolled = false;

    window.addEventListener("scroll", () => {
      const shouldCollapse = window.scrollY > 10;

      if (shouldCollapse && !scrolled) {
        scrolled = true;
        nav.classList.add("scrolled");
        leftSep.classList.add("hidden");
        rightSep.classList.add("hidden");
        title.classList.add("fade");
        setTimeout(() => {
          title.innerHTML = `WHO OWNS THE <span style="color: var(--red1)">FLAVOR?</span>`;
          title.classList.add("shrunk");
          title.classList.remove("fade");
        }, 100);
      } else if (!shouldCollapse && scrolled) {
        scrolled = false;
        title.classList.add("fade");
        setTimeout(() => {
          title.innerHTML = `WHO OWNS<br>THE <span style="color: var(--red1)">FLAVOR?</span>`;
          title.classList.remove("shrunk");
          title.classList.remove("fade");
          leftSep.classList.remove("hidden");
          rightSep.classList.remove("hidden");
          nav.classList.remove("scrolled");
        }, 100);
      }
    });
  </script>
</body>
</html>
